



             Unlikå  thå versioî oæ NSBH19.SRÃ whicè ió iî vol-
        umå  ± oæ thå MTPUÇ library¬  thió  versioî  implementó 
        botè  thå  "FUNCTION¢  anä "CURSOR¢ keyó oî  thå  Heatè 
        terminal®  Thå keypaä anä "FUNCTION¢ keyó acô similarlù 
        tï Compuvie÷ Product'ó "VEDIT¢ program®   Thå  softwarå 
        listing¬ NSBCUR19.SRÃ giveó thå actuaì assignments.

             NSBCUR19.SRÃ  runó properlù oî á ´ MHú Z-8° systeí 
        (ie® iô ió uğ anä running© anä shoulä ruî properlù witè 
        á  µ MHú 808µ systeí sucè aó Godbout'ó  duaì  processoò 
        boarä (ie®  thió processoò waó noô yeô tried¬ buô sincå 
        alì  thå codå generateä bù NSÂ ió 808° code¬  thå µ MHú 
        808µ shoulä executå fasteò thaî thå ´ MHú Z-80).

             Iæ  thió softwarå ió ruî oî á ² MHú  808°  system¬ 
        somå interestinç thingó begiî tï happeî (ie® iô doesn'ô 
        worë  welì aô all)®  Thå FUNCTIOÎ keyó seeí tï generatå 
        alphanumeriã characteró whicè arå inserteä iî thå text®  
        Theù  dï noô perforí accordinç tï thå  CASÅ  statement» 
        however¬ thå standarä controì keyó defineä bù MÔ Micro-
        systemó worë correctly.

             Tï understanä whù thió is¬ wå musô looë aô ho÷ thå 
        FUNCTIOÎ  keyó (includinç outpuô oæ thå shifteä numeriã 
        keypad© arå implementeä oî thå H-19®  Thå standarä keyó 
        transmiô  onå ascié characteò tï thå computeò foò  eacè 
        keù stroke®  Thå FUNCTIOÎ anä CURSOÒ keys¬ oî thå otheò 
        hand¬  transmiô  twï ascié characteró iî rapiä  succes-
        sion®   Thå  firsô oæ theså characteró ió  aî  <ESCAPE¾ 
        (hexadecimaì  1B)»  iô ió useä bù SB_GETCÈ tï differen-
        tiatå betweeî regulaò anä controì sequences®   Thå  se-
        conä characteò ió á standarä alphabetiã character®   Iæ 
        SPĞ doeó noô reacô tï thå controì sequencå sufficientlù 
        fast¬  iô  wilì misó thå ESCAPÅ characteò anä reacô  tï 
        thå seconä character®  Sincå thió characteò ió á "plaiî 
        vanilla¢  alphabetiã  character¬  Speeä thinkó thaô  iô 
        shoulä writå thió characteò intï thå workspace®  Anä iô 
        does!

             SPĞ  useó  á standarä CPÍ calì  tï  determinå  thå 
        currenô consolå status®   Thå timå requireä foò SPĞ anä 
        CP/Í  tï  jointlù procesó thió calì ió longeò thaî  thå 
        bytå  timå  (1.0´ milliseconds© oæ  á  characteò  beinç 
        transmitteä aô 960° baud®  Iô ió possible¬  however¬ tï 
        modifù  SPĞ tï vectoò directlù tï thå BIOS®   MÔ Micro-
        systemó  diä  noô implemenô thå direcô BIOÓ  vectoò  iî 
        theiò packagå becauså oæ theiò desirå tï bå  completelù 
        CP/Í compatible»   Therå ió nï guaranteå thaô thå modi-
        ficatioî  whicè  É wilì describå wilì worë witè  futurå 
        versionó oæ CP/Í oò MP/M®   Iô will¬ however¬ worë witè 
        CP/Í Versionó 1.´ anä 2.2.

             É wilì no÷ attempô tï describå thå procedurå whicè 
        shoulä bå followeä tï implemenô thå direcô calì tï  thå Š

                                        1








        CONSÔ  routinå  iî  thå CP/Í BIOS®   Iæ yoõ  decidå  tï 
        modifù youò versioî oæ SPP¬  pleaså remembeò tï perforí 
        alì  surgerù  oî fileó whicè yoõ caî  afforä  tï  lose®  
        Thaô  is¬  makå aî EXTRÁ COPÙ anä worë witè thió  extrá 
        copy®  Noô witè youò onlù gooä WORKINÇ copy®  Whilå thå 
        procedurå É wilì describå ió straightforward¬ iô caî bå 
        complicateä  foò someonå whï ió noô intimatelù familiaò 
        witè botè CP/Í anä assemblù languagå programming.

             Whilå É aí familiaò onlù witè thå Heatè terminals¬ 
        thió  modificatioî shoulä worë foò anù  terminaì  whicè 
        useó twï characteò sequenceó foò speciaì functioî keys®  
        Somå  terminaló  maù implemenô theiò functioî  keyó  aó 
        controì characteró anä noô requirå thå modification.

             Now¬  tï start®   Begiî bù compilinç youò owî ver-
        sioî oæ NSBCUR19.SRC®  Iæ yoõ havå compileä thå filå aó 
        iô waó submitteä tï MTPUG¬  iô occupieó 15FØ bytes® Yoõ 
        musô  modifù alì oæ thå '.CMD§ fileó useä tï builä  SPĞ 
        bù changinç 160° tï 1700®    Notå thaô É havå shorteneä 
        thå texô whicè appearó oî thå screeî tï conservå space®  
        Accordinç  tï  thå documentation¬  É shoulä bå ablå  tï 
        starô thå overlaù areá aó faò bacë aô 1780H®   However¬ 
        É  havå noô beeî ablå successfullù implemenô  SPĞ  witè 
        overlayó  startinç  pasô  1700H¬  eveî  witè  onlù  thå 
        NSB.SRÃ  supplieä  bù MT®   Iæ anyonå whï  adaptó  thió 
        packagå knowó whù SPĞ actó likå iô does¬  pleaså submiô 
        youò  commentó  tï thå User'ó Grouğ tï sharå  witè  thå 
        resô  oæ us®   Wheî modifyinç thå filå E2.CMD¬  adä thå 
        linkeò  directivå /Í tï providå á symboì tablå  listinç 
        oî thå console®   Yoõ wilì neeä tï finä thå addresó  oæ 
        onå procedurå iî overlaù SPP.002¬ whicè E² builds.

             Next¬  submiô LINKSPĞ iî thå normaì way®  However¬ 
        insteaä  oæ walkinç awaù froí thå terminaì untiì every-
        thinç  ió done¬  staù bù thå terminaì anä  monitoò  thå 
        symboì  tablå  whicè  ió produceä wheî E2.CMÄ  ió  pro-
        cessed®   Finä  thå  addresó oæ thå  symboì  "CHWAITI"®  
        Thió symboì ió thå starô oæ thå functioî whicè  returnó 
        thå  consolå  status®   Oî mù versioî oæ  SPP.002¬  thå 
        addresó oæ CHWAITÉ waó 1A4C®   Writå thió addresó down¬ 
        aó yoõ wilì neeä tï uså iô tï determinå wherå tï  patcè 
        thå SPP.00² overlay.

             Oncå thå submiô filå haó completeä execution¬  thå 
        fuî begins®  First¬ uså SIÄ oò DDÔ tï loaä SPP.00² intï 
        thå  computer®   Aó yoõ recall¬  thå debuggeò loadó thå 
        filå  intï locatioî 100H®   Now¬  takå thå  addresó  oæ 
        CHWAITÉ  anä subtracô froí iô thå starô addresó oæ  thå 
        overlaù area® (iî thió case¬ 1A4C-170° ½ 34C)®  Tï thió 
        value¬  adä 100H®  (agaiî 34Ã « 10° ½ 44C)®   Uså DDT'ó 
        'L§  commanä tï lisô thå codå aô thió locatioî  (L44C)®  
        Thió  codå  shoulä  bå á tablå  oæ  jumğ  instructions®  
        Recorä  thå addresó oæ thå jumğ (iî thió  case¬  1C3B)®  
        Thió  addresó  ió  thå startinç locatioî oæ  thå  patcè Š

                                        2








        whicè  wå  wilì make®   CHWAITÉ ió  á  procedurå  whicè 
        checkó thå statuó oæ thå console®  Wå wilì modifù iô tï 
        calì thå BIOÓ directlù (shorô circuitinç CP/M© tï mini-
        mizå thå timå requireä tï determinå thå consolå status.

             Takå  thå addresó oæ thå jumğ anä subtracô froí iô 
        thå starô oæ thå overlaù areá (1C3Â - 170° ½ 53B)®  Adä 
        100È tï thió valuå (53Â « 10° ½ 63B)®   Uså thå Á  com-
        manä tï writå thå followinç codå intï locatioî 63B:

             A63B <CR>
             63B LHLD 1<CR>
             63E INX H<CR>
             63F INX H<CR>
             640 INX H<CR>
             641 LXI D,1C46<CR> THIS IS THE RETURN ADDR OF THE BIOS CALL
             644 PUSH D<CR> PUSH IT ONTO THE STACK
             645 PCHL<CR>
             646 STA 8D31<CR> DON'T KNOW WHY, BUT HIS ROUTINE DOES
             649 MOV L,A<CR>
             64A MVI H,0<CR>
             64C .<CR>

             That'ó  thå  patch®   Thå twï  instructionó  whicè 
        follo÷ arå XTHÌ anä PCHL®  Fortunately¬ iô takeó SPĞ aó 
        manù  byteó tï seô uğ itó calì tï CP/Í anä transfeò thå 
        informatioî aó iô takeó uó tï tï thå BIOÓ calì  direct-
        ly®   Iæ  SPĞ  tooë lesó spacå tï makå itó  call¬  thió 
        techniquå woulä noô worë toï well.

             Now¬  typå ^Ã tï exiô DDÔ oò SID®   Theî typå SAVÅ 
        10¸ SPP.002®   Iæ you'vå donå everythinç correctly¬ yoõ 
        caî invokå SPP¬ brinç uğ thå editor¬ anä uså thå cursoò 
        keyó  tï youò heart'ó content®   Iæ everythinç  doesn'ô 
        worë out¬  it'ó nicå tï kno÷ thaô thió ió noô thå  onlù 
        disë  witè SPĞ oî iô thaô yoõ have®   Thå probleí  mosô 
        likelù  waó  aî erroò iî determininç thå  addresseó  aô 
        whicè yoõ shoulä enteò thå information¬ oò thå valuå tï 
        loaä  intï  registeò  DÅ anä pusè oî thå stacë  aó  thå 
        returî address.

             Mù thankó tï Mikå Lehmaî whï tolä må whicè  symboì 
        tï  looë  foò anä whï outlineä thå generaì approacè  tï 
        solvå  thå  problem®   Yoõ mighô wondeò whù  MÔ  Micro-
        systemó didn'ô jusô implemenô á direcô calì tï thå BIOÓ 
        sucè aó É havå described®   Thå answeò ió simpleº  theù 
        wanteä theiò softwarå tï worë witè anù versioî oæ  CP/Í 
        whicè mighô comå dowî thå pike®  Theù haä nï choicå buô 
        tï  worë througè CP/Í operatinç systeí calló tï  assurå 
        compatability.

             Therå  arå otheò wayó tï implemenô thå CURSOÒ  anä 
        FUNCTIOÎ  keys®   Onå waù ió tï makå thå consolå  inpuô 
        BIOÓ  routinå  interrupô driveî sï thaô alì  characteró 
        transmitteä  bù  thå terminaì woulä bå  loadeä  intï  á Š

                                        3








        buffer®   Consolå statuó woulä returî truå iæ anù char-
        acteró  werå iî thå buffeò anä falså iæ thå buffeò werå 
        empty®  Thió modå oæ operatioî woulä requirå nï modifi-
        catioî oæ thå SPĞ software®   However¬ manù oæ thå CP/Í 
        implementationó todaù havå nï interrupô capability.

             Onå otheò thing¬  bå surå tï modifù thå  initiali-
        zatioî  switcheó oî youò H-1¹ tï automaticallù senä thå 
        shifteä characteò set®   Otherwise¬  you'lì havå tï de-
        presó  thå  shifô  keù anù timå yoõ wisè  tï  movå  thå 
        cursor.


                                           Jerry Jankura











































                                        4





