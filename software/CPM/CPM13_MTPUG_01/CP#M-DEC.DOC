

*************************************************************************


COVERING:	CPMTODEC,DECTOCPM,LISTDEC

WRITTEN BY:	BRIAN T. CHASE   @ NOSC CODE 8131   8/26/78
		SAN DIEGO, CALIF.


	THESE PROGRAMS ENABLE THE CP/M USER TO TRANSFER FILES BETWEEN
CP/M AND DEC FORMAT DISKETTES, AS WELL AS LISTING THE DEC DISK'S
DIRECTORY.

________________________________________________________________________


1. LISTDEC:	THE PROGRAM IS STARTED BY TYPING "LISTDEC <CR>", AS
	IS ANY CP/M TRANSIENT PROGRAM. THE PROGRAM WILL THEN ASK
	WHETHER OR NOT THE DEC DISK IS INTERLEAVED (SEE NOTE C.)
	AS SOON AS THIS QUESTION IS ANSWERED THE DIRECTORY IS READ IN,
	INTERPRETED, AND PRINTED AT THE CONSOLE. THE PROGRAM THEN
	IMMEDIATELY RETURNS CONTROL TO CP/M (NO REBOOT).

2. CPMTODEC:	TYPE "CPMTODEC <CR>" TO EXECUTE. THE PROGRAM WILL
	FIRST ASK IF USER WANTS TO ZERO (INITIALIZE) THE DEC DISK.
	IF "Y" IS TYPED, IT WILL ASK "ARE YOU SURE?". IF EITHER OF
	THESE QUESTIONS IS ANSWERED BY ANYTHING BUT A "Y", THIS OP-
	TION WILL BE SKIPPED. IF DEC DISK IS TO BE ZEROED, THE MES-
	SAGE "PLACE DEC DISK ON DRIVE B" WILL BE PRINTED (SEE NOTE
	A), FOLLOWED BY THE QUESTION "IS DEC DISK INTERLEAVED?" (SEE
	NOTE C). AFTER THIS QUESTION HAS BEEN ANSWERED, THE DISK ON
	DRIVE B WILL BE ZEROED.
		THE PROGRAM WILL THEN ASK FOR CP/M FILENAME (SOURCE
	FILE ON CP/M DISK). ALL KEYBOARD EDITING COMMANDS ARE
	AVAILABLE. IT THEN REQUESTS THE DEC FILENAME (DESTINATION
	FILE). ALL FILE NAMING CONVENTIONS SHOULD BE OBSERVED. IF
	A SYNTAX ERROR OCCURS, THE PROGRAM ASKS FOR BOTH FILENAMES
	AGAIN (CHECK CHARACTER COUNT IN NAME). THE "PLACE DEC DISK
	ON DRIVE B" MESSAGE IS THEN PRINTED (SEE NOTE A). ANSWER
	THE READY(Y/N)? QUESTION WITH A "Y" WHEN READY-"N" WILL ASK
	FOR NEW FILENAMES.
		WHEN TRANSFER IS COMPLETE, THE MESSAGE "ANOTHER
	TRANSFER(Y/N)?" WILL BE PRINTED. "Y" WILL ASK FOR NEW FILE-
	NAMES, "N" WILL REBOOT SYSTEM (ZERO FIRST TIME ONLY).

3. DECTOCPM:	TYPE "DECTOCPM <CR>" TO EXECUTE. THIS IS SIMILAR
	TO #2 ABOVE EXCEPT THAT THE PROGRAM ASKS IF THE DEC FILE
	IS ASCII. THIS MEANS: IS THE FILE TO BE TRANSFERRED AN
	ASCII SOURCE, LISTING, OR OTHER ASCII-TYPE FILE, OR IS
	IT A DATA FILE OR MACHINE CODE,ETC. FILE. NON-ASCII FILES
	ARE TRANSFERRED ENTIRELY (ALL BLOCKS TRANSFERRED). FOR
	ASCII FILES, THE LAST BLOCK IS CHECKED FOR EOF CHARACTER
	(DIFFERENT IN DEC & CP/M FILE FORMATS). (NO ZERO OPTION).

_________________________________________________________________________

NOTES:

 A.	  THE CP/M STRUCTURE INCLUDES PROVISIONS FOR AT LEAST TWO
	DISK DRIVES. IN ALL THREE OF THESE PROGRAMS, THE DEC DISK
	IS TO BE PLACED ON DRIVE B. FOR THOSE USERS WITH A SINGLE
	DRIVE ON THEIR SYSTEM, CBIOS SHOULD PRINT OUT AN APPROPRIATE
	MESSAGE AT THE CONSOLE WHEN ANY PROGRAM SELECTS A DRIVE NOT
	CURRENTLY BEING ACCESSED. IN THESE PROGRAMS, THE MESSAGE
	"PLACE DEC DISK ON DRIVE B" SHOULD BE IGNORED BY SINGLE
	DRIVE USERS-THEY SHOULD WAIT UNTIL THEIR CBIOS NOTIFIES
	THEM OF THE SWITCH.

 B.	  IT SHOULD BE NOTED THAT TO SIMPLIFY THESE PROGRAMS
	CONSIDERABLY, THE DEC DISK'S DIRECTORY IS ASSUMED TO BE
	EFFECTIVELY ONLY ONE SEGMENT (8 SECTORS) LONG (THEY ARE
	NORMALLY INITIALIZED TO 4 SEGMENTS). THIS IS A REASONABLE
	ASSUMPTION, SINCE UP TO APPROXIMATELY 72 ENTRIES CAN BE
	CONTAINED IN ONE SEGMENT. HOWEVER, IF A FILE CANNOT BE
	FOUND ON THE DEC DISK BY THE DECTOCPM PROGRAM AND A SUB-
	SEQUENT DIRECTORY LISTING ON A DEC COMPUTER SHOWS THE FILE
	PRESENT, THE SOLUTION WOULD BE TO PIP THE DESIRED FILE TO
	ANOTHER DEC DISK WITH FEWER OR NO FILES ON IT (EG A FRESH-
	LY ZEROED DISK).

 C.	  THESE PROGRAMS WERE ALSO WRITTEN TO HANDLE TWO DIFFERENT
	DEC DISK FORMATS:

	  1. STANDARD DEC FORMAT- LOGICAL SECTORS BEGIN ON TRACK 1
	WITH PHYSICAL SECTORS 1,3,5,7...23,25,2,4,6...24,26 (EVERY
	OTHER SECTOR). THIS SEQUENCE IS ALSO SHIFTED BY ADDING AN
	AMOUNT B=6*(TRACK#-1) TO THE TRACK 1 VALUES (IN MOD 26).

	  2. CONSECUTIVE- LOGICAL SECTORS ARE PHYSICAL SECTORS.

	  EACH PROGRAM ASKS IF THE DEC DISK IS INTERLEAVED. THIS IS
	ASKING WHETHER THE DISK IS STANDARD DEC FORMAT OR IF IT IS
	CONSECUTIVE (IE LOGICAL SECTORS=PHYSICAL SECTORS). A FLAG IS
	SET OR RESET FOR THE DISK B HANDLING ROUTINE. THE USER MAY
	WISH TO ALTER THIS FUNCTION IF HE HAS ONLY ONE TYPE OF DEC
	DISK.

 D.	  THE CP/M PROGRAM BEING TRANSFERRED MUST BE ON THE SAME
	DISK THAT THE TRANSFERRING PROGRAM (CPMTODEC OR DECTOCPM) IS
	ON (DUE TO THE AUTOMATIC READ-ONLY STATUS THAT SWITCHING
	DISKS CAUSES IN VERSION 1.4).

*****************************************************************************
