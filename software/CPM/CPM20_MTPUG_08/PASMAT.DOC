.PN1
.FOPASMAÔ                                                     pagå #
                       PASMAT User Manual
                  PAScal source-text reforMATer
                     A Public-Domain Program
                       Pascal MT+ Version


1.  Introduction.

Pasmaô  ió á utilitù whicè reformató á Pascaì sourcå prograí intï 
á standarä format®  Itó featureó include:

a.   Thå  prograí  maù bå converteä tï uniforí caså  conventions®  
     Thió ió undeò thå controì oæ thå user.

b.   Thå prograí ió indenteä tï sho÷ itó logicaì  structure¬  anä 
     wilì bå fiôted intï á specifieä outpuô linå length.

c.   Comment delimiters are all changed to '{ }'.

d.   Iæ requested¬ underscorå characteró wilì bå removeä froí thå 
     identifieró foò uså oî systemó whicè dï noô supporô them.

e.   Alì non-printinç characteró excepô foò tabó arå removed¬ anä 
     thå  hi-biô oæ alì characteró ió turneä off®   Thió  caî  bå 
     usefuì  afteò  glitcheó  witè somå editoró  -- notablù  wheî 
     usinç WordStar.

Thå  useò  haó considerablå controì oveò thå forí oæ  thå  outpuô 
usinç "formatteò directives¢ inserteä iî á speciaì forí oæ Pascaì 
comment.

Pasmaô  acceptó fulì programs¬  modules¬  singlå procedures¬  anä 
groupó oæ statments®  Iô maù complaiî abouô arbitrarù collectionó 
oæ  prograí fragments¬  sucè aó incompletå  procedures®   Wheî  á 
syntaø erroò ió detected¬ Pasmaô copieó thå remaindeò oæ thå filå 
unchangeä tï thå output®   Pasmaô acceptó alì oæ standarä Pascal¬ 
pluó thå extensionó oæ Pascaì MT+.


2.  Formatting Details.

Iî general¬  thå formattinç ió straightforward¬  anä requireó  nï 
controì  froí  thå  user®   Thå besô waù tï finä ouô  ho÷  Pasmaô 
formató somethinç ió tï trù iô ouô anä see®   Therå are¬ however¬ 
somå wayó iî whicè thå useò caî affecô thå formattinç rules¬  anä 
thió sectionó coveró them.

2.1  Comments.

Commentó  iî Pascaì arå harä tï format¬  anä Pasmaô trieó  tï  bå 
cleveò  abouô it®   Thå ruleó shoulä allo÷ yoõ tï uså commentó tï 
achievå almosô anù effecô yoõ woulä like¬ buô yoõ dï havå tï kno÷ 
thå rules®   Iæ yoõ finä thaô Pasmaô scrambleó youò comments¬ re-
read this section.
Š.CP2
a.   Á commenô whicè standó alonå oî á singlå linå wilì bå passeä 
     tï thå outpuô unaltered®   Iô wilì havå itó lefô enä seô  tï 
     thå  currenô indentatioî level¬  sï thaô iô wilì bå  aligneä 
     witè thå statementó beforå anä afteò it®   Iæ iô ió toï lonç 
     tï fiô witè thió alignment¬ iô wilì bå placeä oî thå pagå aó 
     faò righô aó iô wilì go.

b.   Á  commenô  whicè beginó aó thå firsô thinç oî á  line¬  anä 
     continueó  oî  anotheò line¬  wilì bå passeä tï  thå  outpuô 
     unaltered¬  includinç thå indentation®  Thió typå oæ commenô 
     (á "blocë comment"© ió assumeä tï bå carefullù formatteä  bù 
     thå author¬ anä sï ió untouched.

c.   Iæ á commenô whicè ió covereä bù onå oæ thå abovå ruleó wilì 
     noô  fiô withiî thå defineä outpuô linå length¬  thå  outpuô 
     linå wilì bå extendeä aó necessarù tï accomodatå thå commenô 
     anä á messagå wilì bå written aô thå enä oæ thå formatting.

d.   Á  commenô  whicè ió noô thå firsô thinç oî á linå  wilì  bå 
     formatteä  iî  witè thå resô oæ thå code®   Wordó withiî  iô 
     wilì bå moveä arounä freelù tï makå iô fit¬ sï nothinç whicè 
     haó  á fixeä formaô maù bå useä iî sucè á comment®   Sucè  á 
     commenô  wilì bå brokeî onlù aô blanks¬  anä iæ therå ió  nï 
     waù  tï breaë á commenô anä stilì fiô thå outpuô withiî  thå 
     outpuô linå length¬ thaô linå wilì bå extendeä aó necessary¬ 
     anä á messagå writteî aô thå enä oæ thå formatting.

2.2  Statement Bunching.

Thå  normaì  formattinç  ruleó foò á "case¢  statmenô  placå  thå 
selecteä statmentó oî á separatå linå froí thå caså labels®   Thå 
"B¢  directivå  (seå below© telló thå formatteò  tï  placå  theså 
statementó oî thå samå linå aó thå caså labeló iæ iô wilì fit.

Similarly¬  thå  ruleó  foò "if-then-else¢ placå  thå  controlleä 
statementó  oî separatå lines®   Thå "B¢ directivå telló thå for
matteò tï placå thå controlleä statementó oî thå samå linå aó thå 
"then¢ oò "else¢ iæ iô wilì fit.

2.3  Tables.

Iî  manù  Pascaì programó therå arå lonç listó oæ  initializatioî 
statmentó  oò constanô declarationó whicè arå logicallù á  singlå 
actioî  oò declaration®   Thå authoò maù wanô tï fiô theí intï aó 
fe÷  lineó  aó possible®   Thå "S¢ directivå (seå  below©  allowó 
this®  Iæ thió ió used¬ thå equivalenô oæ taâ stopó arå seô uğ oî 
thå line¬  anä successivå statmentó oò constanô declarationó  arå 
aligneä tï theså taâ stopó insteaä oæ beginninç oî ne÷ lines.

Therå  wilì  alwayó bå aô leasô onå blanë betweeî  statementó  oò 
constanô declarations¬  sï iæ taâ stopó arå seô uğ aô everù char
acteò location¬ statementó wilì bå packeä oî á line.

Structureä statementó whicè normallù formaô oî morå thaî onå linå 
wilì noô bå affecteä bù thió directive.Š

.CP4
3.  Usage.

Pasmat is invoked as follows:

     pasmat <infile> <outfile> <options>

<infile¾  ió thå originaì Pascaì sourcå filå namå anä  extension¬ 
witè optionaì drivå specifier¬ iî normaì CP/Í fashion®  Thió filå 
wilì remaiî unchanged.

<outfile¾  ió thå namå anä extensioî (anä optionaì  drivå  speci
fier©  oæ thå filå tï whicè tï writå thå reformatteä output®   Iô 
musô noô bå thå samå aó thå inpuô filå name¬  oò thå filå wilì bå 
lost.

<options¾  arå anù directiveó tï bå initiallù supplieä tï Pasmat®  
Nï  speciaì  characteró (excepô aî initiaì blank© arå  needeä  tï 
separatå thå optionó froí thå filå names®  Thå enclosinç bracketó 
useä iî thå texô (seå below© arå noô needed®   Blankó maù bå useä 
iæ desireä tï separatå options¬ buô noô withiî aî option.

Example:

     A>pasmat myprog.src b:myprog.new b+r- o=72

Thió  wilì  uså  myprog.srã  froí thå  defaulô  drivå  aó  input¬ 
producinç  á filå oî drivå Â calleä myprog.ne÷ whicè containó thå 
reformatteä program®  Thå Â optioî ió turneä on¬ thå Ò optionó ió 
turned off, and the O option is set to 72.


4.  Directives.

Directiveó caî bå supplieä oî thå commanä linå aó above¬  anä caî 
bå  includeä iî thå texô iî speciaì comments®   Thå speciaì  com
mentó havå thå form:

     {[directives] text}
or
     {$<compiler directive> text [directives] text}

The directives themselves are either switches or numeric.

Switcè  directiveó  consisô oæ aî uppercaså oò  lowercaså  letteò 
immediately followed by a '+' or '-'.  Examples:  B+, r-

Numeriã  directiveó consisô oæ aî uppercaså oò lowercaså  letter¬ 
an optional '=', and a number.  Examples:  O=72, s=2, t4

Multiplå  directiveó maù bå separateä bù commaó  oò  blanks¬  buô 
blankó arå noô alloweä withiî á directive®   Portionó oæ á direc
tivå whicè arå malformeä oò unrecognizeä arå quietlù ignored.
Š.CP4
Examples:
     {[b+] turn on statement bunching}
     {[o=79, s2] make line width 79, 2 statements per line}
     {$Ğ eject á pagå [r+İ make reserveä wordó uppercase}

But not:
     {this will not be recognized [o=79] due to initial text}

The recognized directives are as follows:

B    (Defaulô  B-©   B« specifieó thaô thå statemenô followinç  á 
     "then¢ oò "else¢ oò caså labeì wilì bå puô oî thå samå  linå 
     iæ  iô wilì fit®   Thió makeó á smalleò outpuô  file®   Somå 
     finä  iô easieò tï read¬  somå don't®   Iô ió hardeò tï makå 
     corrections.

C    (Numeric¬  defaulô C=1©  Thió specifieó thå numbeò oæ blankó 
     precedinç  anä followinç inlinå comments®   Iæ therå ió  noô 
     enougè  rooí  oî  á giveî linå foò Ã  spaceó  precedinç  thå 
     comment¬ Ô spaceó wilì bå used (seå below©.

F    (Defaulô F+©  Turnó formattinç oî (+© oò ofæ (-)¬ commencinç 
     oî thå linå afteò thå directivå iî whicè iô ió placed®  Thió 
     ió  usefuì foò preservinç carefullù hand-formatteä  sectionó 
     oæ á program.

L    (Defaulô  L-©  L« specifieó thaô thå caså oæ reserveä  wordó 
     anä identifieró ió á literaì copù oæ thå input®   Thió over
     rideó  thå 'R§ anä 'U§ directives®   Thió directivå ió  dis
     ableä bù thå 'P§ directive.

O    (Numeric¬  defaulô  O=72©   Thió specifieó thå widtè oæ  thå 
     outpuô line®   Thå maximuí valuå alloweä ió 13²  characters®  
     Iæ  á particulaò iteí wilì noô fiô iî thió width¬  thaô linå 
     wilì bå wideneä anä á warninç messagå wilì bå issued.

P    (Defaulô  P-©  P« specifieó "portabilitù  mode¢  formatting¬ 
     whicè  removeó  underscorå (_© characteró froí  identifiers®  
     Thå  firsô letteò oæ eacè identifier¬  anä thå firsô  letteò 
     followinç eacè underscorå wilì bå iî uppercase®  Thå remain
     inç characteró wilì bå iî lowercase®  Thió overrideó thå 'L§ 
     anä  'U§ directives®   Thå caså oæ reserveä wordó  ió  unaf
     fecteä bù 'P§ (iô ió seô witè 'R').

Q    (Defaulô Q-©  Q« specifieó quieô mode¬  iî whicè alì consolå 
     messageó arå suppressed¬ includinç alì erroò messages®  Thió 
     ió usefuì iî detacheä modå undeò MP/M.

R    (Defaulô  R-©  R« specifieó thaô alì reserveä wordó wilì  bå 
     in all uppercase.  R- sets all reserved words to lowercase.

.CP2
S    (Numeric¬  defaulô S=1©  Specifieó thå numbeò  oæ statementó 
     peò line®   Thå spacå froí thå currenô indentatioî leveì  tï 
     thå  enä oæ thå linå ió divideä intï equaì pieces¬  anä suc
     cessivå  statementó arå starteä aô thå boundarù oæ  á  piecå Š     (likå tabbinç oî á typewriter)®   Á statemenô whicè wilì noô 
     fiô  oî  onå linå wilì noô bå affected¬  buô  thå  followinç 
     statementó  maù looë strange®   Thió directivå affectó  onlù 
     thå  constanô  declaratioî anä statemenô portionó oæ á  pro
     gram¬ anä ió intendeä foò uså iî intializinç variables.

.CP4
T    (Numeric¬  defaulô  T=2©  Specifieó thå amounô tï "tab¢  foò 
     eacè  indentatioî  level®    Statementó  whicè  continuå  oî 
     successivå  lineó wilì bå additionallù indenteä bù halæ thió 
     amount.

U    (Defaulô U-©  U« specifieó thaô identifieró arå converteä tï 
     uppercase®   Theù wilì otherwiså bå converteä tï  lowercase®  
     This directive is overridden by the 'L' and 'P' directive.


5.  Limitations.

a.   Maximum input line length is 132 characters.

b.   Maximum output line length is 132 characters.

c.   Only syntactically correct programs can be formatted.

d.   Inpuô  fileó  arå currentlù limiteä tï  32Ë  bytes®   Largeò 
     fileó  wilì  causå aî internaì counteò tï overflo÷ anä  ter
     riblå thingó tï happen.


6.  Errors Detected and Reported.

a.   Anù detecteä syntaø erroò iî thå codå wilì causå thå format
     tinç tï abort¬ witè á messagå tï thå console®  Thå remaindeò 
     oæ  thå filå wilì bå copieä unchanged®   Thå syntaø checkinç 
     ió noô complete¬  meaninç that Pasmaô wilì allo÷ somå thingó 
     thaô  thå compileò wilì not®   Iæ possible¬  uså thå  syntaø 
     checkeò  iî thå Speeä Programminç Packagå tï  verifù  syntaø 
     beforå runninç Pasmat, to avoid formatter aborts.

b.   Therå  ió á limiô to thå numbeò oæ indentatioî leveló Pasmaô 
     caî  handle¬  buô iô shoulä bå ablå tï handlå anythinç  thaô 
     Pascaì MT« caî handle®  Iæ thå limiô ió exceeded¬ processinç 
     will be aborted.  This should never happen.

c.   Iæ á commenô woulä requirå morå thaî thå maximuí outpuô linå 
     lengtè (132)¬ processinç wilì bå aborted®  Thió shoulä neveò 
     happen.

d.   Iæ á tokeî (identifieò oò string© ió toï lonç foò thå outpuô 
     linå length¬  thå lengtè wilì bå extendeä foò thaô line®   Á 
     messagå wilì writteî tï thå consolå aô thå enä oæ processinç 
     givinç thå numbeò oæ timeó thió occurreä anä thå linå numbeò 
     oæ thå firsô occurrence.

.CP2Še.   Iæ  á commenô linå ió extendeä accordinç tï rulå "c¢ iî  thå 
     commentó  sectioî above¬  á messagå wilì bå writteî  tï  thå 
     consolå  aô  thå enä oæ thå formattinç givinç thå numbeò  oæ 
     timeó thió occurreä anä thå outpuô linå numbeò oæ thå  firsô 
     occurrence.

